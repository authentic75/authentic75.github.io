---
title: "Network: ARP와 Transparent Bridging"
last_modified_at: 2020-06-29T20:20:02-05:00
categories:
  - Network
tags:
  - ARP
  - Transparent Bridging
toc: true 
toc_label: "Table of Contents"
toc_icon: "cog"
toc_sticky: true 
author_profile: true 
read_time: false 
---

---
### 토폴로지 기본 설정 
---

<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/Topology/ARP.JPG" alt="">
  <figcaption>VLAN을 위한 기본 토폴로지 설정</figcaption>
</figure> 

```
R1#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
R1(config)#int fa 0/0
R1(config-if)#ip address 1.1.1.1 255.255.255.0
R1(config-if)#mac-address 0000.0000.0001
R1(config-if)#no shut
```
```
R2#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
R2(config)#int fa 0/0
R2(config-if)#ip address 1.1.1.2 255.255.255.0
R2(config-if)#mac-address 0000.0000.0002
R2(config-if)#no shut
```
```
R3#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
R3(config)#int fa 0/0
R3(config-if)#ip address 1.1.1.3 255.255.255.0
R3(config-if)#mac-address 0000.0000.0003
R3(config-if)#no shut
```
```
SW1#show cdp neighbors
Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge
                  S - Switch, H - Host, I - IGMP, r - Repeater, P - Phone,
                  D - Remote, C - CVTA, M - Two-port Mac Relay

Device ID        Local Intrfce     Holdtme    Capability  Platform  Port ID
R2               Eth 0/3           149             R S I  3745      Fas 0/0
R3               Eth 0/2           168             R S I  3745      Fas 0/0
R1               Eth 0/1           178             R S I  3745      Fas 0/0
```

---
### ARP 개념
---

* 이더넷 프레임을 만들기 위해서는 출발지 MAC 주소와 목적지 MAC 주소가 필요하다
* 처음 통신을 시작할 때는 상대방의 MAC주소를 모른다
* **ARP: 이더넷에서 상대방의 MAC주소를 알아내기 위하여 사용하는 프로토콜**
{: .notice}

* **동작방식**
* IP 주소가 1.1.1.1인 R1에서 R2로 Ping한다고 가정하자
* 목적지 IP 주소는 Ping에 명시하므로 알 수 있다 (1.1.1.2 라고 가정하자)
* 1.1.1.2의 MAC 주소를 알아내기 위해 FFFF:FFFF:FFFF 로 ARP 요청 프레임을 전송한다
* R2와 R3가 ARP 요청 패킷을 받고 1.1.1.2가 자신의 주소임을 알고 ARP 응답 패킷을 보낸다
	* R3는 응답하지 않는다
* ARP 응답을 수신한 R1은 MAC의 주소를 알게되고 ARP테이블에 저장한다
{: .notice}

`상대의 MAC 주소가 필요`
| 목적지 MAC 주소 | 출발지 MAC 주소 | 출발지 IP 주소 | 목적지 IP 주소 | 데이터 |
| ------------ | ------------ | ----------- | ----------- | ---- |
|              | 0000.0000.0001 | 1.1.1.1 | 1.1.1.2 | 10101..... |

`ARP 요청 프레임`
| 목적지 MAC 주소 | 출발지 MAC 주소 | 출발지 IP 주소 | 목적지 IP 주소 | 데이터 |
| ------------ | ------------ | ----------- | ----------- | ---- |
| FFFF.FFFF.FFFF | 0000.0000.0001 | 1.1.1.1 | 1.1.1.2 | ARP 요청 |

`ARP 응답 패킷`
| 목적지 MAC 주소 | 출발지 MAC 주소 | 출발지 IP 주소 | 목적지 IP 주소 | 데이터 |
| ------------ | ------------ | ----------- | ----------- | ---- |
| 0000.0000.0001 | 0000.0000.0002 | 1.1.1.2 | 1.1.1.1 | ARP 응답 |

`핑 요청 패킷의 전송`
| 목적지 MAC 주소 | 출발지 MAC 주소 | 출발지 IP 주소 | 목적지 IP 주소 | 데이터 |
| ------------ | ------------ | ----------- | ----------- | ---- |
| 0000.0000.0002 | 0000.0000.0001 | 1.1.1.1 | 1.1.1.2 | 10101.... |

`핑 응답 패킷의 전송`
| 목적지 MAC 주소 | 출발지 MAC 주소 | 출발지 IP 주소 | 목적지 IP 주소 | 데이터 |
| ------------ | ------------ | ----------- | ----------- | ---- |
| 0000.0000.0001 | 0000.0000.0002 | 1.1.1.2 | 1.1.1.1 | 1010... |


---
### 트랜스패런트 브리징 개념
---

```
SW1#show mac address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----
   1    0000.0000.0001    DYNAMIC     Et0/1
   1    0000.0000.0002    DYNAMIC     Et0/3
   1    0000.0000.0003    DYNAMIC     Et0/2
Total Mac Addresses for this criterion: 3
```

```
SW1#show mac address-table count

Mac Entries for Vlan 1:
---------------------------
Dynamic Address Count  : 3
Static  Address Count  : 0
Total Mac Addresses    : 3

Total Mac Address Space Available: 183046404
```
























