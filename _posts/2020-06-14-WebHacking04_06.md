---
title: "Security: webhacking.kr 04_06"
last_modified_at: 2020-06-14T20:20:02-05:00
categories:
  - Security
tags:
  - webhacking.kr
  - 웹해킹
toc: true 
toc_label: "Table of Contents"
toc_icon: "cog"
toc_sticky: true 
author_profile: true 
read_time: false 
---

---
### 04 문제 풀이 (sha1 hash)
---
---
#### SHA1 hash
---

**해시함수란**
* 임의의 길이의 데이터를 입력받아 고정된 길이의 비트열로 반환 시켜주는 함수이다. 
* 동일한 값이 입력되면 동일한 출력값을 보장한다.
* 단방향 암호화로 A로 만들어진 B를 가지고 다시 A를 구할 수 없다는 특징을 가진다.
* 눈사태 효과 란 입력값의 아주 작은 변화로도 결과값이 전혀 다르게 도출되는 효과를 의미한다.
	* 입력값에 점 하나만 추가되어도 전혀 다른 출력값이 출력된다.
{: .notice--info}

**SHA-1**은 SHA 함수들 중 가장 많이 쓰이며, 
TLS, SSL, PGP, SSH, IPSec 등 많은 보안 프로토콜과 프로그램에서 사용되고 있다. 
SHA-1은 이전에 널리 사용되던 MD5를 대신해서 쓰이기도 한다.
{: .notice--info}

* md5의 출력값 길이는 128비트
	* md5 hash값(저장 : 16진수로 32바이트)
* sha-1의 출력값 길이는 160비트
	* sha-1 hash값(저장 : 16진수로 40바이트)
* sha-256의 출력값 길이는 256비트
	* sha-256 hash값(저장 : 16진수로 64바이트)
{: .notice}

**SHA1 알고리즘을 이용하여 평문의 해쉬값을 구한 예**  
SHA1("The quick brown fox jumps over the lazy dog")   
= 2fd4e1c67a2d28fced849ee1bb76e7391b93eb12
{: .notice--warning}

**해시값은 눈사태 효과 때문에 메시지가 조금만 바뀌어도 완전히 바뀔 수 있다.**    
SHA1("The quick brown fox jumps over the lazy dog.")   
= 408d94384216f890ff7a0c3528e8bed1e0b01621   
예시 출처: SHA - 위키백과 
{: .notice--warning}

**레인보우 테이블**  
해쉬함수는 역함수가 존재하지 않는다. 그래서 모든 경우의 수를 데이터베이스에 저장하고 
 뽑아낸 해쉬값을 레인보우 테이블과 대조하여 평문을 찾아내는 것이다.
{: .notice--danger}

---
#### 문제 풀이
---
<figure class="align-center">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제4/4-1.PNG" alt="">
  <figcaption> </figcaption>
</figure>

```php
<?php
  include "../../config.php";
  if($_GET['view-source'] == 1) view_source();
?><html>
<head>
<title>Challenge 4</title>
<style type="text/css">
body { background:black; color:white; font-size:9pt; }
table { color:white; font-size:10pt; }
</style>
</head>
<body><br><br>
<center>
<?php
  sleep(1); // anti brute force
  if((isset($_SESSION['chall4'])) && ($_POST['key'] == $_SESSION['chall4'])) solve(4);
  $hash = rand(10000000,99999999)."salt_for_you";
  $_SESSION['chall4'] = $hash;
  for($i=0;$i<500;$i++) $hash = sha1($hash);
?><br>
<form method=post>
<table border=0 align=center cellpadding=10>
<tr><td colspan=3 style=background:silver;color:green;><b><?=$hash?></b></td></tr>
<tr align=center><td>Password</td><td><input name=key type=text size=30></td><td><input type=submit></td></tr>
</table>
</form>
<a href=?view-source=1>[view-source]</a>
</center>
</body>
</html>
```

```php
<?php
  sleep(1); // anti brute force
  if((isset($_SESSION['chall4'])) && ($_POST['key'] == $_SESSION['chall4'])) solve(4);
  $hash = rand(10000000,99999999)."salt_for_you";
  $_SESSION['chall4'] = $hash;
  for($i=0;$i<500;$i++) $hash = sha1($hash);
?>
```
코드의 일부분을 해석해보자면 올바른 'key'값을 입력하여 이것이 $_SESSION['chall4']과 일치해야하는데,
여기서 $_SESSION['chall4']값은 10000000,99999999 사이 랜덤값에 "salt_for_you"라는 문자열을 붙인후 sha1 해쉬 알고리즘을 통해
500번 암호화를 한 값이다. 이를 풀어내려면 레인보우 테이블을 만들어야할 것 같다.
{: .notice}
---
### 05 문제 풀이
---

---
### 06 문제 풀이
---
