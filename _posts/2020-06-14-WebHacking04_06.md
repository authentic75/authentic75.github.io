---
title: "Security: webhacking.kr 04"
last_modified_at: 2020-06-14T20:20:02-05:00
categories:
  - Security
tags:
  - webhacking.kr
  - 웹해킹
toc: true 
toc_label: "Table of Contents"
toc_icon: "cog"
toc_sticky: true 
author_profile: true 
read_time: false 
---

---
### 04 문제 풀이 (sha1 hash 문제)
---

<figure class="align-center">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제4/4-1.PNG" alt="">
  <figcaption> </figcaption>
</figure>

```php
<?php
  include "../../config.php";
  if($_GET['view-source'] == 1) view_source();
?><html>
<head>
<title>Challenge 4</title>
<style type="text/css">
body { background:black; color:white; font-size:9pt; }
table { color:white; font-size:10pt; }
</style>
</head>
<body><br><br>
<center>
<?php
  sleep(1); // anti brute force
  if((isset($_SESSION['chall4'])) && ($_POST['key'] == $_SESSION['chall4'])) solve(4);
  $hash = rand(10000000,99999999)."salt_for_you";
  $_SESSION['chall4'] = $hash;
  for($i=0;$i<500;$i++) $hash = sha1($hash);
?><br>
<form method=post>
<table border=0 align=center cellpadding=10>
<tr><td colspan=3 style=background:silver;color:green;><b><?=$hash?></b></td></tr>
<tr align=center><td>Password</td><td><input name=key type=text size=30></td><td><input type=submit></td></tr>
</table>
</form>
<a href=?view-source=1>[view-source]</a>
</center>
</body>
</html>
```

```php
<?php
  sleep(1); // anti brute force
  if((isset($_SESSION['chall4'])) && ($_POST['key'] == $_SESSION['chall4'])) solve(4);
  $hash = rand(10000000,99999999)."salt_for_you";
  $_SESSION['chall4'] = $hash;
  for($i=0;$i<500;$i++) $hash = sha1($hash);
?>
```
코드의 일부분을 해석해보자면 올바른 'key'값을 입력하여 이것이 $_SESSION['chall4']과 일치해야하는데,
여기서 $_SESSION['chall4']값은 10000000,99999999 사이 랜덤값에 "salt_for_you"라는 문자열을 붙인후 sha1 해쉬 알고리즘을 통해
500번 암호화를 한 값이다. 이를 풀어내려면 레인보우 테이블을 만들어야할 것 같다.
{: .notice}
---
### 05 문제 풀이
---

---
### 06 문제 풀이
---
